<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="products-style.css">
    <script src="./products_data.js"></script>
    <title>Document</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        let params = (new URL(document.location)).searchParams;
        var quantityqstring = "";
        var usernameqstring = "";
        // form was submitted so process the invoice
        console.log("Got to the loop");
        for (i = 0; i < products.length; i++) {
            if (params.has(`quantity${i}`)) {
                a_qty = params.get(`quantity${i}`);
                console.log("Quantity = " + a_qty);
                quantityqstring += `&quantity${i}=` + a_qty;
                console.log(quantityqstring);

            }
        }
        the_user = params.get("user");
        if (the_user == null) {
            the_user = "Unknown User";
            Write = `Sorry ${the_user}, you must log in or register before viewing the invoice!`;
            document.write(Write);
            
            console.log(the_user);
        }

        usernameqstring += `&user=` + the_user

        outStr = `<meta http-equiv="Refresh" content="5;url=/product_invoice.html?${quantityqstring}${usernameqstring}">`;
        document.write(outStr);
    </script>

    <script>
    

        outStr = `
</head>
<body>
    <br>
    <br>
    <br>
    <h2>Successful Registration!</h2>
    <p>If you see this message for more than 5 seconds, please click on the link below!</p>
    <p><a href="/product_invoice.html?${quantityqstring}${usernameqstring}">Invoice Page</a></p>
    <br>
    <br>
    <br>
</body>`;
        document.write(outStr);
    </script>
        
</html>