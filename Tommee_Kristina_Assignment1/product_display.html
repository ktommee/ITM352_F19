<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Simply Fruit Baskets</title>
    <script src="./public/products_data.js"></script>
    <link rel="stylesheet" href="products-style.css">
    

    <script>
        function isNonNegInt(q, return_errors = false) {
        errors = []; // assume no errors at first
        if(q == '') q =0; // handle blank inputs as if they are 0
        if (Number(q) != q) errors.push('<font color="red">Not a number!</font>'); // Check if string is a number value
        else if (q < 0) errors.push('<font color="red">Negative value!</font>'); // Check if it is non-negative
        else if (parseInt(q) != q) errors.push('<font color="red">Not an integer!</font>'); // Check that it is an integer
        return return_errors ? errors : (errors.length == 0);
    }



        function checkQuantityTextbox(theTextbox) {
        errs = isNonNegInt(theTextbox.value, true); // don't want a boolean; want the actual errors array
        document.getElementById(theTextbox.name + '_span').innerHTML = errs.join(", "); // get the errors array and turn it into a string 
    }

    </script>
</head>

<body>
    <form name="quantity_form" action="./product_invoice.html" method="GET">
        <header>
            <h1>...Simply Fruit Baskets...</h1>

            <h2>Purchase a basket for a $7.99 and choose your fruits!</h2>
        </header>
        <div>
            <main>
                <table border="2">
                    
                        <tr>
                            <th style="text-align: center;" width="30%">Product</th>
                            <th style="text-align: center;" width="30%">Price</th>
                            <th style="text-align: center;" width="10%">Variety</th>
                            <th style="text-align: center;" width="20%">Image</th>
                            <th style="text-align: center;" width="40%">Quantity</th>
                        </tr>

                        <script>
                            for (i = 0; i < products.length; i++) {
                                Outstr = '';
                                Outstr += `<tr><td style="text-align: center;" width = "50%">${products[i].product}</td>`
                                    + `<td style="text-align: center;" width = "11%">$${products[i].price}</td>`
                                    + `<td style="text-align: center;" width = "30%">${products[i].variety }</td>`
                                    + `<td width = "10%"><img src = "${products[i].image}"></td>`
                                    + `<td> <input type="text" name="quantity${i}" onkeyup="checkQuantityTextbox(this);"><span id="quantity${i}_span"}"></span></td></tr>`;
                                 
                                document.write(Outstr);
                                


                            }

                        </script>

                </table>
            </main>
        </div>
        <footer>
            <input type="submit" value='Purchase!' name="purchase_submit_button"> 
        </footer>
    </form>
</body>

<img src="https://res.cloudinary.com/bloomnation/c_pad,d_vendor:global:catalog:product:image.png,f_auto,fl_preserve_transparency,q_auto/v1531778417/vendor/6646/catalog/product/d/b/dbfa4ec802061a7bbfb7c7132f9579ba_2_11.jpg" alt="Fruit Baskets" style="text-align: center;" height="30%" width="30%"></a> 

</html>

<script>
/*let params = (new URL(document.location)).searchParams;
GET = {};
params.forEach(function (value, key) { GET[key] = value });

//document.write(`<h3>${products[0]["model"]} at \$${products[0]["price"]}</h3>`);

if (typeof GET['quantity_textbox'] != 'undefined') {
    userIn = GET['quantity_textbox'];
    if (isNonNegInt(userIn)) {
        document.write(`Thank you for purchasing ${userIn} things`);
        window.stop();
    }
}

function isNonNegInt(i, sendArrayBack = false) {
    errors = []; // assume no errors at first
    if (Number(i) != i) errors.push('Not a number!'); // Check if string is a number value
    if (i < 0) errors.push('Negative value!'); // Check if it is non-negative
    if (parseInt(i) != i) errors.push('Not an integer!'); // Check that it is an integer

    if (sendArrayBack) {
        return (errors);

    } else {
        return (errors.length == 0);
    }

}
function checkquantity() {
    errs = isNonNegInt(quantity_form.quantity_textbox.value, true);
    if (errs.length > 0) {
        qty_textbox_message.innerHTML = errs.join(",");
    } else {
        qty_textbox_message.innerHTML = quantity_form.quantity_textbox.value;

    }


}
 <link rel="stylesheet" href="products-style2.css">

function checkQuantityTextbox(theTextbox) {
    errs = isNonNegInt(theTextbox.value, true);
    if (errs.length == 0) errs = ['You want:'];
    if (theTextbox.value.trim() == '') errs = ['Quantity'];
    document.getElementById(theTextbox.name + '_span').innerHTML = errs.join(", ");
}
*/
</script>

